cmake_minimum_required (VERSION 2.6)
PROJECT(protoc-gen-php)

INCLUDE(FindProtobuf)
FIND_PACKAGE(Protobuf REQUIRED)
FIND_PACKAGE(Threads)

PROTOBUF_GENERATE_CPP(PHP_OPTIONS_SRCS PHP_OPTIONS_HDRS "php_options.proto")
INCLUDE_DIRECTORIES(
	${PROTOBUF_INCLUDE_DIR}
	${CMAKE_CURRENT_BINARY_DIR}
)
CONFIGURE_FILE(php_options.proto php_options.proto COPYONLY)

FILE(GLOB SRC_PHP_GEN *.cc)

ADD_EXECUTABLE(protoc-gen-php ${SRC_PHP_GEN} ${PHP_OPTIONS_SRCS})
TARGET_LINK_LIBRARIES(protoc-gen-php ${PROTOBUF_LIBRARIES})
TARGET_LINK_LIBRARIES(protoc-gen-php ${PROTOBUF_PROTOC_LIBRARY})
INSTALL(TARGETS protoc-gen-php DESTINATION /usr/bin/)
INSTALL(FILES php_options.proto DESTINATION /usr/local/include)
